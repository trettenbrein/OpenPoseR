---
title: "Comparision of OpenPose(R) and SLMotion"
author: "PC Trettenbrein & E Zaccarella"
date: "2/27/2019"
output:
  html_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr) # For reading CSV files
library(ggplot2) # For fancy plotting
```

# Introduction

This document provides a comparision of our analysis pipeline of the motion-tracking data derived from using OpenPose with comparable data generated by [SLMotion](https://research.cs.aalto.fi/cbir/software/slmotion/), a now defunct software packagae that was explicitly designed to analyse sign language video clips and derive motion-tracking information from them.

Note that neither of these motion-tracking methods was built for "sign recognition" (in analogy to voice recognition). Instead, the primary purpose (here) is stimulus control, that is the quantification of different motion-related parameters in order to ensure consistency accross video stimuli as used in reserach on sign language and gesture.

## Example videos

We'll be working with the following example videos to compare the results and accuracy of the different methods: Three hort video clips of the German Sign Language (DGS) signs for EVENING, TROUSERS, and IDEA (taken from Trettenbrein, Pendzich, Cramer, et al., in preparation).

These signs were chosen because of their phonological properites:

* EVENING is a symmetric two-handed sign with a path-movement in which the hands shorlty overlap during the signs path movement.
* TROUSERS is a two-handed sign that is produced in sign space in front of the body.
* IDEA is a one-handed sign that is produced using the dominant hand in Y-handhshape next to the head.

<style>
.column {
  float: left;
  width: 33.33%;
}

/* Clear floats after the columns */
.row:after {
  content: "";
  display: table;
  clear: both;
}
</style>

<div class="row">
  <div class="column">
  <video width="95%" controls>
    <source src="example_videos/ABEND.mp4" type="video/mp4">
  </video>
  EVENING
  </div>
  <div class="column">
  <video width="95%" controls>
    <source src="example_videos/HOSE.mp4" type="video/mp4">
  </video>
  TROUSERS
  </div>
  <div class="column">
  <video width="95%" controls>
    <source src="example_videos/IDEE.mp4" type="video/mp4">
  </video>
  IDEA
   </div>
</div>

# SLMotion

```{r slmotion, echo=FALSE}
dataSLM <- read.csv(system.file("extdata", "ABEND_SLM.csv", package = "OpenPoseR",
                                mustWork = TRUE))
ggplot(data=dataSLM, aes(x=framenr)) +
  geom_line(aes(y=total_length_sum_vvec), colour = "red")
```

# OpenPoseR

<div class="row">
  <div class="column">
  <video width="95%" controls>
    <source src="openpose_data/ABEND_OpenPose.mp4" type="video/mp4">
  </video>
  EVENING
  </div>
  <div class="column">
  <video width="95%" controls>
    <source src="openpose_data/HOSE_OpenPose.mp4" type="video/mp4">
  </video>
  TROUSERS
  </div>
  <div class="column">
  <video width="95%" controls>
    <source src="openpose_data/IDEE_OpenPose.mp4" type="video/mp4">
  </video>
  IDEA
   </div>
</div>

We compute the Euclidean norms of the sums of velocity and acceleration vectors $MF_1 = \lVert \sum_{i=1}^{N} v_i \rVert$ and $MF_2 = \lVert \sum_{i=1}^{N} a_i \rVert$.

```{r openpose, echo=FALSE}
dataOP <- read.csv(system.file("extdata", "ABEND_body25_cleaned_en_velocity.csv",
                               package = "OpenPoseR", mustWork = TRUE))
dataOP$frame <- seq.int(nrow(dataOP))
ggplot(data=dataOP, aes(x=frame)) +
  geom_line(aes(y=Euclidean_norm_velocity), colour = "red") +
  xlab("Frame") +
  ylab("Euclidean norm of the sums of velocity vectors") +
  ggtitle("Bodily movement in video clip EVENING")
```

```{r comparison, echo=FALSE}
comp <- data.frame()
comp <- cbind(dataSLM$total_length_sum_vvec)
comp <- cbind(comp, dataOP$Euclidean_norm_velocity)
comp <- cbind(comp, seq.int(nrow(comp)))
colnames(comp) <- c("slm", "op", "frame")
comp <- data.frame(comp)

ggplot(data=comp, aes(x=frame)) +
  geom_line(aes(y=slm), colour = "red") +
  geom_line(aes(y=op), colour = "blue")

#cor.test(dataSLM$total_length_sum_vvec[2:98], dataOP[,1])

```
